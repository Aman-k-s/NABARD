<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Farmer Voice Assistant (Fixed Language)</title>
</head>
<body>
  <h2>ğŸŒ¾ Farmer Voice Assistant</h2>
  <p>Select language:</p>
  <button onclick="setLang('en-IN')">ğŸ‡¬ğŸ‡§ English</button>
  <button onclick="setLang('hi-IN')">ğŸ‡®ğŸ‡³ Hindi</button>

  <p id="question">Click Start after choosing language.</p>
  <button id="startBtn">ğŸ¤ Start</button>
  <p id="output">Transcript: â€”</p>

  <script>
    let currentLang = null;
    const questions_en = [
      "Which crop are you growing?",
      "Which fertilizer did you use?",
      "How many days did you keep water in the field?"
    ];
    const questions_hi = [
      "à¤†à¤ª à¤•à¥Œà¤¨ à¤¸à¥€ à¤«à¤¸à¤² à¤‰à¤—à¤¾ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚?",
      "à¤†à¤ªà¤¨à¥‡ à¤•à¥Œà¤¨ à¤¸à¤¾ à¤‰à¤°à¥à¤µà¤°à¤• à¤‡à¤¸à¥à¤¤à¥‡à¤®à¤¾à¤² à¤•à¤¿à¤¯à¤¾?",
      "à¤†à¤ªà¤¨à¥‡ à¤–à¥‡à¤¤ à¤®à¥‡à¤‚ à¤•à¤¿à¤¤à¤¨à¥‡ à¤¦à¤¿à¤¨ à¤ªà¤¾à¤¨à¥€ à¤°à¤–à¤¾?"
    ];
    let currentQ = 0;
    let answers = {};

    const qDiv = document.getElementById("question");
    const oDiv = document.getElementById("output");
    const startBtn = document.getElementById("startBtn");

    function setLang(lang){
      currentLang = lang;
      qDiv.textContent = "Language set to " + (lang==="en-IN"?"English":"Hindi");
    }

    async function askQuestion(){
      if(!currentLang){ alert("Please select a language first!"); return; }
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const rec = new SpeechRecognition();
      rec.lang = currentLang;
      rec.interimResults = false;
      rec.onresult = e => {
        const text = e.results[0][0].transcript.trim();
        oDiv.textContent = "Transcript: " + text;
        answers["Q"+(currentQ+1)] = text;
        currentQ++;
        if(currentQ < 3){
          qDiv.textContent = (currentLang==="en-IN"?questions_en:questions_hi)[currentQ];
          askQuestion();
        } else {
          qDiv.textContent = "âœ… Done. Answers: " + JSON.stringify(answers);
        }
      };
      rec.start();
    }

    startBtn.addEventListener("click", ()=>{
      currentQ = 0; answers={};
      qDiv.textContent = (currentLang==="en-IN"?questions_en:questions_hi)[currentQ];
      askQuestion();
    });
  </script>
</body>
</html>
